(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{537:function(n,a,t){n.exports=t.p+"assets/img/6.fabfcd63.png"},538:function(n,a,t){n.exports=t.p+"assets/img/op_show.42b47503.png"},539:function(n,a,t){n.exports=t.p+"assets/img/ros_v3_interface.c4ac901c.png"},540:function(n,a,t){n.exports=t.p+"assets/img/ros_v3_instances.a9d55930.png"},541:function(n,a,t){n.exports=t.p+"assets/img/ros_v3_area.83466515.png"},542:function(n,a,t){n.exports=t.p+"assets/img/ros_v3_area_range.2aec2596.png"},543:function(n,a,t){n.exports=t.p+"assets/img/ros_v3_neighbors.ba1f4fee.png"},544:function(n,a,t){n.exports=t.p+"assets/img/ros_v3_route.058083b1.png"},545:function(n,a,t){n.exports=t.p+"assets/img/test_to_upstream.8e1ac6a6.png"},546:function(n,a,t){n.exports=t.p+"assets/img/test_to_outside.797e7ce3.png"},565:function(n,a,t){"use strict";t.r(a);var r=t(6),e=Object(r.a)({},(function(){var n=this,a=n.$createElement,r=n._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[r("h2",{attrs:{id:"前言"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[n._v("#")]),n._v(" 前言")]),n._v(" "),r("p",[n._v("使用openwrt的quagga和ros实现ipv6的ospf路由协议")]),n._v(" "),r("h2",{attrs:{id:"环境配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#环境配置"}},[n._v("#")]),n._v(" 环境配置")]),n._v(" "),r("ul",[r("li",[n._v("openwrt19(预先编译好quagga，位于network---routing-and-redirection位置)")]),n._v(" "),r("li",[n._v("ros")])]),n._v(" "),r("h2",{attrs:{id:"环境架构"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#环境架构"}},[n._v("#")]),n._v(" 环境架构")]),n._v(" "),r("ul",[r("li",[n._v("无奈上层分配到/128的地址无法再继续ra分发，所以内部ipv6自己做了规划，使用nat-ipv6")])]),n._v(" "),r("p",[r("img",{attrs:{src:t(537),alt:""}})]),n._v(" "),r("h2",{attrs:{id:"openwrt配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#openwrt配置"}},[n._v("#")]),n._v(" openwrt配置")]),n._v(" "),r("ol",[r("li",[n._v("通过ssh进入openwrt")]),n._v(" "),r("li",[n._v("vtysh进入quagga配置模式")]),n._v(" "),r("li",[n._v("配置ospf")])]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("router ospf6\n router-id 1.10.100.100\n area 0.0.1.0 range fd7a:4ffa:3b3c::/64\n interface br-lan area 0.0.1.0\n")])])]),r("p",[n._v("在使用ospfv3的interface上添加")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("interface br-lan\n ipv6 ospf6 network broadcast\n")])])]),r("ol",{attrs:{start:"4"}},[r("li",[n._v("完整配置过程")])]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("root@OpenWrt:~# vtysh\n\nHello, this is Quagga (version 1.1.1).\nCopyright 1996-2005 Kunihiro Ishiguro, et al.\n\nOpenWrt# configure terminal\nOpenWrt(config)# router ospf6\nOpenWrt(config-ospf6)# router-id 1.10.100.100\nOpenWrt(config-ospf6)# interface br-lan area 0.0.1.0\nOpenWrt(config-ospf6)# area 0.0.1.0 range fd7a:4ffa:3b3c::/64\nOpenWrt(config-ospf6)# exit\nOpenWrt(config)# interface br-lan\nOpenWrt(config-if)# ipv6 ospf6 cost 10\nOpenWrt(config-if)# exit\nOpenWrt(config)# exit\nOpenWrt# show running-config\nBuilding configuration...\n\nCurrent configuration:\n!\n!\ndebug ospf6 lsa unknown\n!\npassword zebra\n!\ninterface br-lan\n ipv6 ospf6 network broadcast\n!\ninterface br-vlan3\n!\ninterface eth0\n!\ninterface eth0.1\n!\ninterface eth0.2\n!\ninterface eth0.3\n!\ninterface ifb0\n!\ninterface ifb1\n!\ninterface lo\n!\ninterface tap_soft\n!\ninterface tunx\n!\ninterface wlan0\n!\ninterface wlan1\n!\nrouter ospf\n ospf router-id 1.10.100.100\n network 100.100.10.0/24 area 0.0.0.10\n default-information originate\n!\nrouter ospf6\n router-id 1.10.100.100\n area 0.0.1.0 range fd7a:4ffa:3b3c::/64\n interface br-lan area 0.0.1.0\n!\naccess-list vty permit 127.0.0.0/8\naccess-list vty deny any\n!\nip forwarding\nipv6 forwarding\n!\nline vty\n access-class vty\n!\nend\nOpenWrt# write\nBuilding Configuration...\nConfiguration saved to /etc/quagga/zebra.conf\nConfiguration saved to /etc/quagga/ripd.conf\nConfiguration saved to /etc/quagga/ripngd.conf\nConfiguration saved to /etc/quagga/ospfd.conf\nConfiguration saved to /etc/quagga/ospf6d.conf\nConfiguration saved to /etc/quagga/bgpd.conf\n[OK]\nOpenWrt#\n")])])]),r("h2",{attrs:{id:"ros的配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#ros的配置"}},[n._v("#")]),n._v(" ros的配置")]),n._v(" "),r("ul",[r("li",[n._v("自写该文章时，ros的dhcpv6只支持pd模式，无法给dhcpv6-client分配ipv6地址，故使用ra进行无状态分配ip地址")]),n._v(" "),r("li",[n._v("managed-address-configuration=no 不从dhcpv6获取ipv6地址(因为没有)")]),n._v(" "),r("li",[n._v("other-configuration=no 不从dhcpv6获取其他信息(原因同上)")]),n._v(" "),r("li",[n._v("openwrt的quagga不支持下发默认ipv6路由，需要自行手动添加")])]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("[admin@MikroTik] /ipv6 address> add address=fdad:c:1:2::1/64 advertise=yes interface=vlan3\n[admin@MikroTik] /ipv6 address> .. \n[admin@MikroTik] /ipv6> nd \n[admin@MikroTik] /ipv6 nd> add interface=vlan3 advertise-mac-address=yes advertise-dns=no managed-address-configuration=no other-configuration=no\n[admin@MikroTik] /ipv6 nd> / \n[admin@MikroTik] > routing ospf-v3  \n[admin@MikroTik] /routing ospf-v3> instance  \n[admin@MikroTik] /routing ospf-v3 instance> add name=ospfv3 router-id=10.10.100.100 redistribute-connected=as-type-1 \n[admin@MikroTik] /routing ospf-v3 instance>  .. \n[admin@MikroTik] /routing ospf-v3> area  \n[admin@MikroTik] /routing ospf-v3 area> add area-id=0.0.1.0 name=ospfv3-area1 instance=ospfv3\n[admin@MikroTik] /routing ospf-v3 area> .. \n[admin@MikroTik] /routing ospf-v3> area range  \n[admin@MikroTik] /routing ospf-v3 area range> add area=ospfv3-area1 range=fd7a:4ffa:3b3c::/64 advertise=no\n[admin@MikroTik] /routing ospf-v3 area range> .. \n[admin@MikroTik] /routing ospf-v3 area> .. \n[admin@MikroTik] /routing ospf-v3> interface  \n[admin@MikroTik] /routing ospf-v3 interface> add area=ospfv3-area1 interface=bridge1  \n")])])]),r("h2",{attrs:{id:"效果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#效果"}},[n._v("#")]),n._v(" 效果")]),n._v(" "),r("ul",[r("li",[n._v("openwrt")])]),n._v(" "),r("p",[r("img",{attrs:{src:t(538),alt:""}})]),n._v(" "),r("ul",[r("li",[n._v("ros")])]),n._v(" "),r("p",[r("img",{attrs:{src:t(539),alt:""}})]),n._v(" "),r("p",[r("img",{attrs:{src:t(540),alt:""}})]),n._v(" "),r("p",[r("img",{attrs:{src:t(541),alt:""}})]),n._v(" "),r("p",[r("img",{attrs:{src:t(542),alt:""}})]),n._v(" "),r("p",[r("img",{attrs:{src:t(543),alt:""}})]),n._v(" "),r("p",[r("img",{attrs:{src:t(544),alt:""}})]),n._v(" "),r("ul",[r("li",[n._v("ping6 上层")])]),n._v(" "),r("p",[r("img",{attrs:{src:t(545),alt:""}})]),n._v(" "),r("ul",[r("li",[n._v("ping6 外层")])]),n._v(" "),r("p",[r("img",{attrs:{src:t(546),alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);