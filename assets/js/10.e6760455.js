(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{525:function(n,t,r){n.exports=r.p+"assets/img/struct_ipv4.f85f2b41.png"},526:function(n,t,r){n.exports=r.p+"assets/img/op_show.c4e7f2eb.png"},527:function(n,t,r){n.exports=r.p+"assets/img/ros_show_area.8acd2d5b.png"},528:function(n,t,r){n.exports=r.p+"assets/img/ros_show_instances.d15e0894.png"},529:function(n,t,r){n.exports=r.p+"assets/img/ros_show_interface.732f8309.png"},530:function(n,t,r){n.exports=r.p+"assets/img/ros_show_neighbors.26a8f9a7.png"},531:function(n,t,r){n.exports=r.p+"assets/img/ros_show_network.cce25a4f.png"},532:function(n,t,r){n.exports=r.p+"assets/img/test_to_upstream.e06261fe.png"},533:function(n,t,r){n.exports=r.p+"assets/img/test_to_baidu.a703b5f8.png"},563:function(n,t,r){"use strict";r.r(t);var a=r(6),e=Object(a.a)({},(function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[n._v("#")]),n._v(" 前言")]),n._v(" "),a("p",[n._v("使用openwrt的quagga和ros将两个网段通过ospf路由协议进行链接")]),n._v(" "),a("h2",{attrs:{id:"环境设备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境设备"}},[n._v("#")]),n._v(" 环境设备")]),n._v(" "),a("ul",[a("li",[n._v("openwrt19(预先编译好quagga，位于network---routing-and-redirection位置)")]),n._v(" "),a("li",[n._v("ros")])]),n._v(" "),a("h2",{attrs:{id:"环境架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境架构"}},[n._v("#")]),n._v(" 环境架构")]),n._v(" "),a("p",[a("img",{attrs:{src:r(525),alt:""}})]),n._v(" "),a("h2",{attrs:{id:"openwrt配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openwrt配置"}},[n._v("#")]),n._v(" openwrt配置")]),n._v(" "),a("ol",[a("li",[n._v("通过ssh进入openwrt")]),n._v(" "),a("li",[n._v("vtysh进入quagga配置模式")]),n._v(" "),a("li",[n._v("配置ospf")])]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("router ospf\n ospf router-id 1.10.100.100\n network 100.100.10.0/24 area 0.0.0.10\n default-information originate\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[n._v("完整过程如下")])]),n._v(" "),a("ul",[a("li",[n._v("default-information originate 分发默认路由到ros")])]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("root@OpenWrt:~# vtysh\n\nHello, this is Quagga (version 1.1.1).\nCopyright 1996-2005 Kunihiro Ishiguro, et al.\n\nOpenWrt# configure terminal\nOpenWrt(config)# router ospf\nOpenWrt(config-router)# ospf router-id 1.10.100.100\nOpenWrt(config-router)# network 100.100.10.0/24 area 0.0.0.10\nOpenWrt(config-router)# default-information originate\nOpenWrt(config-router)# exit\nOpenWrt(config)# exit\nOpenWrt# show running-config\nBuilding configuration...\n\nCurrent configuration:\n!\n!\ndebug ospf6 lsa unknown\n!\npassword zebra\n!\ninterface br-lan\n!\ninterface br-vlan3\n!\ninterface eth0\n!\ninterface eth0.1\n!\ninterface eth0.2\n!\ninterface eth0.3\n!\ninterface ifb0\n!\ninterface ifb1\n!\ninterface lo\n!\ninterface tunx\n!\ninterface wlan0\n!\ninterface wlan1\n!\nrouter ospf\n ospf router-id 1.10.100.100\n network 100.100.10.0/24 area 0.0.0.10\n default-information originate\n!\naccess-list vty permit 127.0.0.0/8\naccess-list vty deny any\n!\nip forwarding\nipv6 forwarding\n!\nline vty\n access-class vty\n!\nend\nOpenWrt# write\nBuilding Configuration...\nConfiguration saved to /etc/quagga/zebra.conf\nConfiguration saved to /etc/quagga/ripd.conf\nConfiguration saved to /etc/quagga/ripngd.conf\nConfiguration saved to /etc/quagga/ospfd.conf\nConfiguration saved to /etc/quagga/ospf6d.conf\nConfiguration saved to /etc/quagga/bgpd.conf\n[OK]\nOpenWrt#\n")])])]),a("h2",{attrs:{id:"配置ros"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置ros"}},[n._v("#")]),n._v(" 配置ros")]),n._v(" "),a("ul",[a("li",[n._v("redistribute-connected=as-type-1 是为了将网卡的100.100.100.0/24重分发到ospf路由，而不用宣告这个网段")])]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("[admin@MikroTik] > routing ospf instance  \n[admin@MikroTik] /routing ospf instance> add name=ospf1 router-id=10.10.100.100 redistribute-connected=as-type-1 \n[admin@MikroTik] /routing ospf instance> .. \n[admin@MikroTik] /routing ospf> area  \n[admin@MikroTik] /routing ospf area> add name=upstream area-id=0.0.0.10 instance=ospf1 \n[admin@MikroTik] /routing ospf area> .. \n[admin@MikroTik] /routing ospf> network  \n[admin@MikroTik] /routing ospf network> add network=100.100.10.0/24 area=upstream  \n[admin@MikroTik] /routing ospf network>\n")])])]),a("h2",{attrs:{id:"验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[n._v("#")]),n._v(" 验证")]),n._v(" "),a("ul",[a("li",[a("p",[n._v("openwrt\n"),a("img",{attrs:{src:r(526),alt:""}})])]),n._v(" "),a("li",[a("p",[n._v("ros\n"),a("img",{attrs:{src:r(527),alt:""}})])])]),n._v(" "),a("p",[a("img",{attrs:{src:r(528),alt:""}})]),n._v(" "),a("p",[a("img",{attrs:{src:r(529),alt:""}})]),n._v(" "),a("p",[a("img",{attrs:{src:r(530),alt:""}})]),n._v(" "),a("p",[a("img",{attrs:{src:r(531),alt:""}})]),n._v(" "),a("ul",[a("li",[n._v("ping openwrt")])]),n._v(" "),a("p",[a("img",{attrs:{src:r(532),alt:""}})]),n._v(" "),a("ul",[a("li",[n._v("ping 百度")])]),n._v(" "),a("p",[a("img",{attrs:{src:r(533),alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);