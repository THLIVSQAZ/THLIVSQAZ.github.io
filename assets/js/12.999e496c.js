(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{547:function(a,n,e){a.exports=e.p+"assets/img/harbor-configure1.ae846b00.png"},548:function(a,n,e){a.exports=e.p+"assets/img/harbor-configure2.2d06d515.png"},549:function(a,n,e){a.exports=e.p+"assets/img/harbor1.e129a0b2.png"},550:function(a,n,e){a.exports=e.p+"assets/img/harbor2.5bcb7a1c.png"},551:function(a,n,e){a.exports=e.p+"assets/img/harbor3.d8e5023c.png"},566:function(a,n,e){"use strict";e.r(n);var r=e(6),t=Object(r.a)({},(function(){var a=this,n=a.$createElement,r=a._self._c||n;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h2",{attrs:{id:"介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[a._v("#")]),a._v(" 介绍")]),a._v(" "),r("p",[a._v("harbor 比起docker官方的registry更好用一些，具体介绍见"),r("a",{attrs:{href:"https://goharbor.io/",target:"_blank",rel:"noopener noreferrer"}},[a._v("此"),r("OutboundLink")],1)]),a._v(" "),r("h2",{attrs:{id:"_1-环境准备"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-环境准备"}},[a._v("#")]),a._v(" 1.环境准备")]),a._v(" "),r("p",[a._v("首先需要docker环境，这里就不做详细docker安装记录了")]),a._v(" "),r("h3",{attrs:{id:"生成key"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#生成key"}},[a._v("#")]),a._v(" 生成key")]),a._v(" "),r("p",[a._v("docker上传镜像时默认使用443端口ssl，同时为了安全性，使用自签ssl证书，有条件的也可以用合法证书")]),a._v(" "),r("p",[a._v("下面过程与"),r("a",{attrs:{href:"https://goharbor.io/docs/2.0.0/install-config/configure-https/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方操作"),r("OutboundLink")],1),a._v("一致")]),a._v(" "),r("ul",[r("li",[a._v("生成CA")])]),a._v(" "),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[a._v("$ "),r("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" key\nharbor@store:~$ "),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" key/\nharbor@store:~/key$ openssl genrsa -out ca.key "),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v("\nGenerating RSA private key, "),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v(" bit long modulus "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" primes"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".++++\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("++++\ne is "),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("65537")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("0x010001"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('$ openssl req -x509 -new -nodes -sha512 -days 3650 -subj "/C=CN/ST=Beijing/L=Beijing/O=example/OU=Personal/CN=172.16.2.50" -key ca.key -out ca.crt\nCan\'t load /home/harbor/.rnd into RNG\n140707690516928:error:2406F079:random number generator:RAND_load_file:Cannot open file:../crypto/rand/randfile.c:88:Filename=/home/harbor/.rnd\nharbor@store:~/key$ ls\nca.crt  ca.key\n')])])]),r("ul",[r("li",[a._v("生成server key")])]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('harbor@store:~/key$ openssl genrsa -out 172.16.2.50.key 4096\nGenerating RSA private key, 4096 bit long modulus (2 primes)\n..............................++++\n........................................................................................................................................................................++++\ne is 65537 (0x010001)\nharbor@store:~/key$ openssl req -sha512 -new \\\n> -subj "/C=CN/ST=Beijing/L=Beijing/O=example/OU=Personal/CN=172.16.2.50" \\\n> -key 172.16.2.50.key \\\n> -out 172.16.2.50.csr\nCan\'t load /home/harbor/.rnd into RNG\n140189655491008:error:2406F079:random number generator:RAND_load_file:Cannot open file:../crypto/rand/randfile.c:88:Filename=/home/harbor/.rnd\nharbor@store:~/key$ ls\n172.16.2.50.csr  172.16.2.50.key  ca.crt  ca.key\n')])])]),r("p",[a._v("把DNS.1改为自己的ip或域名，如有更多则在后面加DNS.2 = ... 累加")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("$ cat > v3.ext <<-EOF\n> authorityKeyIdentifier=keyid,issuer\n> basicConstraints=CA:FALSE\n> keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment\n> extendedKeyUsage = serverAuth\n> subjectAltName = @alt_names\n>\n> [alt_names]\n> DNS.1=172.16.2.50\n> EOF\n")])])]),r("ul",[r("li",[a._v("用CA证书生成最后的 server key")])]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~/key$ openssl x509 -req -sha512 -days 3650 \\\n> -extfile v3.ext \\\n> -CA ca.crt -CAkey ca.key -CAcreateserial \\\n> -in 172.16.2.50.csr \\\n> -out 172.16.2.50.crt\nSignature ok\nsubject=C=CN ST=Beijing L=Beijing O=example OU=Personal CN = 172.16.2.50\nGetting CA Private Key\nharbor@store:~/key$ ls\n172.16.2.50.crt  172.16.2.50.csr  172.16.2.50.key  ca.crt  ca.key  ca.srl  v3.ext\n")])])]),r("h2",{attrs:{id:"_2-安装harbor"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装harbor"}},[a._v("#")]),a._v(" 2.安装harbor")]),a._v(" "),r("p",[a._v("到"),r("a",{attrs:{href:"https://github.com/goharbor/harbor/releases",target:"_blank",rel:"noopener noreferrer"}},[a._v("此处"),r("OutboundLink")],1),a._v("下载harbor离线包")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~$ tar xvf harbor-offline-installer-v2.0.1.tgz\nharbor/harbor.v2.0.1.tar.gz\nharbor/prepare\nharbor/LICENSE\nharbor/install.sh\nharbor/common.sh\nharbor/harbor.yml.tmpl\n")])])]),r("p",[a._v("导入镜像")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("ajsb@store:~/harbor$ sudo docker load -i harbor.v2.0.1.tar.gz\n872a1466e826: Loading layer [==================================================>]   34.5MB/34.5MB\n4dfc82127cd7: Loading layer [==================================================>]  11.15MB/11.15MB\n47b4670d0c8c: Loading layer [==================================================>]  4.096kB/4.096kB\n59a86010a270: Loading layer [==================================================>]  3.072kB/3.072kB\n8da9cc70d93c: Loading layer [==================================================>]  23.44MB/23.44MB\nd29455fc5f40: Loading layer [==================================================>]  9.309MB/9.309MB\n40f9cab7875f: Loading layer [==================================================>]  33.57MB/33.57MB\nLoaded image: goharbor/trivy-adapter-photon:v2.0.1\nf6a133cb2572: Loading layer [==================================================>]  10.28MB/10.28MB\nacd2089a7647: Loading layer [==================================================>]  8.488MB/8.488MB\n160ddbb834ae: Loading layer [==================================================>]  178.7kB/178.7kB\nb93d21b59a32: Loading layer [==================================================>]  157.2kB/157.2kB\nb8c931eb34bd: Loading layer [==================================================>]  33.28kB/33.28kB\n2e6d494d68eb: Loading layer [==================================================>]  17.41kB/17.41kB\n5dedceb07ec6: Loading layer [==================================================>]  15.36kB/15.36kB\nbfcc4645a906: Loading layer [==================================================>]  3.584kB/3.584kB\nLoaded image: goharbor/harbor-portal:v2.0.1\n2fa644b45f81: Loading layer [==================================================>]  12.22MB/12.22MB\nd1ad40890fc7: Loading layer [==================================================>]  3.584kB/3.584kB\nce9fad8a1c82: Loading layer [==================================================>]   2.56kB/2.56kB\n67b8071f0c5a: Loading layer [==================================================>]  46.52MB/46.52MB\na9620284cd5e: Loading layer [==================================================>]  5.632kB/5.632kB\n08026e081903: Loading layer [==================================================>]   51.2kB/51.2kB\n455144b92cb5: Loading layer [==================================================>]  47.34MB/47.34MB\n5a0b179edfe6: Loading layer [==================================================>]   2.56kB/2.56kB\nLoaded image: goharbor/harbor-core:v2.0.1\nd793bae4f6cd: Loading layer [==================================================>]  12.22MB/12.22MB\n37bc5ee2f872: Loading layer [==================================================>]  3.584kB/3.584kB\n78da87a5755a: Loading layer [==================================================>]   2.56kB/2.56kB\n6c8f6f3c4ee6: Loading layer [==================================================>]  35.69MB/35.69MB\n716fdde605b5: Loading layer [==================================================>]  36.51MB/36.51MB\nLoaded image: goharbor/harbor-jobservice:v2.0.1\n99a45366ce4e: Loading layer [==================================================>]  8.435MB/8.435MB\nd20e5e66643d: Loading layer [==================================================>]  6.317MB/6.317MB\n73eb8f38314b: Loading layer [==================================================>]  16.04MB/16.04MB\n512b6e175cf0: Loading layer [==================================================>]  28.25MB/28.25MB\nd9dc0e504aed: Loading layer [==================================================>]  22.02kB/22.02kB\nbe53af8f5ad0: Loading layer [==================================================>]   50.6MB/50.6MB\nLoaded image: goharbor/notary-server-photon:v2.0.1\n0eadd51ada25: Loading layer [==================================================>]  49.89MB/49.89MB\n18b13e8a8839: Loading layer [==================================================>]  3.584kB/3.584kB\ne2755348bd4b: Loading layer [==================================================>]  3.072kB/3.072kB\na62d077cd0fe: Loading layer [==================================================>]   2.56kB/2.56kB\n9c98500bf643: Loading layer [==================================================>]  3.072kB/3.072kB\n33d51c5e29bb: Loading layer [==================================================>]  3.584kB/3.584kB\ne9f3f1e2c1cf: Loading layer [==================================================>]  12.29kB/12.29kB\n66f402bc9ecf: Loading layer [==================================================>]  5.632kB/5.632kB\nLoaded image: goharbor/harbor-log:v2.0.1\nad8d57802e83: Loading layer [==================================================>]  8.441MB/8.441MB\ne1ed8500fea6: Loading layer [==================================================>]  4.096kB/4.096kB\n8490b02320fa: Loading layer [==================================================>]  3.072kB/3.072kB\ne153d67d6e37: Loading layer [==================================================>]  20.94MB/20.94MB\n51c195249ffd: Loading layer [==================================================>]  21.76MB/21.76MB\nLoaded image: goharbor/registry-photon:v2.0.1\n818525ddd265: Loading layer [==================================================>]  8.435MB/8.435MB\neb29d444582b: Loading layer [==================================================>]  6.317MB/6.317MB\n9ac7c150b0aa: Loading layer [==================================================>]  14.61MB/14.61MB\n118de7396af0: Loading layer [==================================================>]  28.25MB/28.25MB\n7f58a60c50a0: Loading layer [==================================================>]  22.02kB/22.02kB\n66d4cfbdcf31: Loading layer [==================================================>]  49.17MB/49.17MB\nLoaded image: goharbor/notary-signer-photon:v2.0.1\n950b2585869c: Loading layer [==================================================>]  116.1MB/116.1MB\n90ac3291b314: Loading layer [==================================================>]  12.15MB/12.15MB\n01fac6521224: Loading layer [==================================================>]  3.072kB/3.072kB\nb12eaa59458a: Loading layer [==================================================>]  49.15kB/49.15kB\n194e8fedab1e: Loading layer [==================================================>]  4.096kB/4.096kB\n4308b3ef3b0d: Loading layer [==================================================>]  13.03MB/13.03MB\nLoaded image: goharbor/clair-photon:v2.0.1\n4261ed016572: Loading layer [==================================================>]   8.44MB/8.44MB\n6858af1d1e26: Loading layer [==================================================>]   67.5MB/67.5MB\n11194ef05958: Loading layer [==================================================>]  3.072kB/3.072kB\ncabc2fa0c773: Loading layer [==================================================>]  4.096kB/4.096kB\n0a914324569b: Loading layer [==================================================>]  68.33MB/68.33MB\nLoaded image: goharbor/chartmuseum-photon:v2.0.1\n43e8c74dcd83: Loading layer [==================================================>]  77.25MB/77.25MB\nb72b0af578f3: Loading layer [==================================================>]   48.5MB/48.5MB\n21f82c396f32: Loading layer [==================================================>]   2.56kB/2.56kB\n0c8391266d8a: Loading layer [==================================================>]  1.536kB/1.536kB\nd0340c876127: Loading layer [==================================================>]  18.43kB/18.43kB\n81dc58743fd4: Loading layer [==================================================>]  3.957MB/3.957MB\nae6d1d2a7c6a: Loading layer [==================================================>]  249.3kB/249.3kB\nLoaded image: goharbor/prepare:v2.0.1\n3c574d52ca8f: Loading layer [==================================================>]  63.57MB/63.57MB\n110d0675acf1: Loading layer [==================================================>]  65.19MB/65.19MB\n7e9e0b5f83b2: Loading layer [==================================================>]  5.632kB/5.632kB\ncc62802e9fac: Loading layer [==================================================>]   2.56kB/2.56kB\ne7b41679bdb2: Loading layer [==================================================>]   2.56kB/2.56kB\nb834aea1a9b5: Loading layer [==================================================>]   2.56kB/2.56kB\nadbd713a6478: Loading layer [==================================================>]   2.56kB/2.56kB\nfb7d245b830e: Loading layer [==================================================>]  10.75kB/10.75kB\nLoaded image: goharbor/harbor-db:v2.0.1\nee2e0b1d599f: Loading layer [==================================================>]  8.441MB/8.441MB\ne0d7d18a67f9: Loading layer [==================================================>]  4.096kB/4.096kB\n675f3bebc4a9: Loading layer [==================================================>]  20.94MB/20.94MB\nae865bc6f2e9: Loading layer [==================================================>]  3.072kB/3.072kB\n90b7ec2096a3: Loading layer [==================================================>]  8.721MB/8.721MB\na01119f3dc08: Loading layer [==================================================>]  30.48MB/30.48MB\nLoaded image: goharbor/harbor-registryctl:v2.0.1\nb51080ad06a0: Loading layer [==================================================>]  10.28MB/10.28MB\nLoaded image: goharbor/nginx-photon:v2.0.1\n6877651d3dad: Loading layer [==================================================>]  39.45MB/39.45MB\nd669ab31064d: Loading layer [==================================================>]  3.072kB/3.072kB\n2bfec584ce57: Loading layer [==================================================>]   59.9kB/59.9kB\n4a2b47a7af21: Loading layer [==================================================>]  61.95kB/61.95kB\nLoaded image: goharbor/redis-photon:v2.0.1\nb3f687a8426d: Loading layer [==================================================>]  8.441MB/8.441MB\n5ccbc18d5052: Loading layer [==================================================>]  4.096kB/4.096kB\nee6594efb4ec: Loading layer [==================================================>]  3.072kB/3.072kB\nd10a03922272: Loading layer [==================================================>]   9.71MB/9.71MB\n4b45e21e42b6: Loading layer [==================================================>]  10.53MB/10.53MB\nLoaded image: goharbor/clair-adapter-photon:v2.0.1\n")])])]),r("h2",{attrs:{id:"_3-配置harobr并启动"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置harobr并启动"}},[a._v("#")]),a._v(" 3.配置harobr并启动")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~/harbor$ cp harbor.yml.tmpl harbor.yml\nharbor@store:~/harbor$ vim harbor.yml\n")])])]),r("p",[r("img",{attrs:{src:e(547),alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:e(548),alt:""}})]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~$ sudo mkdir -p /data/cert/\nharbor@store:~$ cd key/\nharbor@store:~/key$ ls\n172.16.2.50.crt  172.16.2.50.csr  172.16.2.50.key  ca.crt  ca.key  ca.srl  v3.ext\nharbor@store:~/key$ sudo cp 172.16.2.50.crt /data/cert/\nharbor@store:~/key$ sudo cp 172.16.2.50.key /data/cert/\n")])])]),r("p",[a._v("生成docker-compose文件")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~/harbor$ sudo ./prepare\nprepare base dir is set to /home/harbor/harbor\nClearing the configuration file: /config/registryctl/env\nClearing the configuration file: /config/registryctl/config.yml\nClearing the configuration file: /config/log/rsyslog_docker.conf\nClearing the configuration file: /config/log/logrotate.conf\nClearing the configuration file: /config/db/env\nClearing the configuration file: /config/jobservice/env\nClearing the configuration file: /config/jobservice/config.yml\nClearing the configuration file: /config/core/env\nClearing the configuration file: /config/core/app.conf\nClearing the configuration file: /config/registry/passwd\nClearing the configuration file: /config/registry/config.yml\nClearing the configuration file: /config/nginx/nginx.conf\nGenerated configuration file: /config/log/logrotate.conf\nGenerated configuration file: /config/log/rsyslog_docker.conf\nGenerated configuration file: /config/nginx/nginx.conf\nGenerated configuration file: /config/core/env\nGenerated configuration file: /config/core/app.conf\nGenerated configuration file: /config/registry/config.yml\nGenerated configuration file: /config/registryctl/env\nGenerated configuration file: /config/registryctl/config.yml\nGenerated configuration file: /config/db/env\nGenerated configuration file: /config/jobservice/env\nGenerated configuration file: /config/jobservice/config.yml\nloaded secret from file: /data/secret/keys/secretkey\nGenerated configuration file: /compose_location/docker-compose.yml\nClean up the input dir\n")])])]),r("p",[a._v("启动")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('harbor@store:~/harbor$ sudo docker-compose up -d\n[sudo] password for harbor:\nCreating network "harbor_harbor" with the default driver\nCreating harbor-log ... done\nCreating redis         ... done\nCreating registry      ... done\nCreating registryctl   ... done\nCreating harbor-portal ... done\nCreating harbor-db     ... done\nCreating harbor-core   ... done\nCreating nginx             ... done\nCreating harbor-jobservice ... done\n')])])]),r("h2",{attrs:{id:"_4-登陆dashboard"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-登陆dashboard"}},[a._v("#")]),a._v(" 4.登陆dashboard")]),a._v(" "),r("p",[r("img",{attrs:{src:e(549),alt:""}})]),a._v(" "),r("p",[r("img",{attrs:{src:e(550),alt:""}})]),a._v(" "),r("h2",{attrs:{id:"_5-上传验证"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-上传验证"}},[a._v("#")]),a._v(" 5.上传验证")]),a._v(" "),r("p",[a._v("在客户机上要忽略ssl(合法证书请跳过)\n"),r("a",{attrs:{href:"https://goharbor.io/docs/2.0.0/install-config/run-installer-script/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方操作"),r("OutboundLink")],1)]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~$ sudo vim /etc/docker/daemon.json\n")])])]),r("p",[a._v("确保有一下内容")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v('{\n"insecure-registries" : ["myregistrydomain.com:5000", "0.0.0.0"]\n}\n')])])]),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~$ sudo docker login 172.16.2.50\nUsername: admin\nPassword:\nWARNING! Your password will be stored unencrypted in /home/harbor/.docker/config.json.\nConfigure a credential helper to remove this warning. See\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store\n\nLogin Succeeded\n")])])]),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("harbor@store:~$ sudo docker tag mariadb 172.16.2.50/library/mariadb\nharbor@store:~$ sudo docker push 172.16.2.50/library/mariadb\nThe push refers to repository [172.16.2.50/library/mariadb]\nc983a66b0607: Pushed\n129e268c775e: Pushed\n73ad928fc596: Pushed\n03992d5cf827: Pushed\n890e9a5b0320: Pushed\na30162e7ce5c: Pushed\n7c26f7fb7882: Pushed\n522fa5afadeb: Pushed\n048cc1fc2213: Pushed\n544a70a875fc: Pushed\ncf0f3facc4a3: Pushed\n132bcd1e0eb5: Pushed\nd22cfd6a8b16: Pushed\nlatest: digest: sha256:86e368b140a863112799c1f366fd04172733dc440353e9334007ea9f37a9b3db size: 3035\n")])])]),r("p",[r("img",{attrs:{src:e(551),alt:""}})])])}),[],!1,null,null,null);n.default=t.exports}}]);