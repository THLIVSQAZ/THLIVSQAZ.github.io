(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{498:function(e,t,a){e.exports=a.p+"assets/img/ceph-problem1.e362e93e.png"},499:function(e,t,a){e.exports=a.p+"assets/img/ceph-img1.fa36b236.png"},500:function(e,t,a){e.exports=a.p+"assets/img/ceph-img2.8f3ea710.png"},501:function(e,t,a){e.exports=a.p+"assets/img/ceph-problem2.693a3169.png"},502:function(e,t,a){e.exports=a.p+"assets/img/ceph-problem3.7e360381.png"},503:function(e,t,a){e.exports=a.p+"assets/img/ceph3.25f0b3b7.png"},504:function(e,t,a){e.exports=a.p+"assets/img/ceph4.590c8dcc.png"},505:function(e,t,a){e.exports=a.p+"assets/img/ceph1.bbbf6381.png"},506:function(e,t,a){e.exports=a.p+"assets/img/ceph2.42d83cbf.png"},560:function(e,t,a){"use strict";a.r(t);var s=a(6),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"搭建环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#搭建环境"}},[e._v("#")]),e._v(" 搭建环境")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("主机名")]),e._v(" "),s("th",{staticStyle:{"text-align":"center"}},[e._v("IP")]),e._v(" "),s("th",{staticStyle:{"text-align":"left"}},[e._v("服务")]),e._v(" "),s("th",{staticStyle:{"text-align":"left"}},[e._v("系统")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("ceph-1")]),e._v(" "),s("td",{staticStyle:{"text-align":"center"}},[e._v("172.16.90.3")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("mon,osd,mgr")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("ubuntu 18.04.4")])]),e._v(" "),s("tr",[s("td",[e._v("ceph-2")]),e._v(" "),s("td",{staticStyle:{"text-align":"center"}},[e._v("172.16.90.4")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("mon,osd,mgr")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("ubuntu 18.04.4")])]),e._v(" "),s("tr",[s("td",[e._v("ceph-3")]),e._v(" "),s("td",{staticStyle:{"text-align":"center"}},[e._v("172.16.70.9")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("osd")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("ubuntu 18.04.4")])])])]),e._v(" "),s("h2",{attrs:{id:"_1-前期准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-前期准备"}},[e._v("#")]),e._v(" 1 前期准备")]),e._v(" "),s("h3",{attrs:{id:"配置host"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置host"}},[e._v("#")]),e._v(" 配置host")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ceph@ceph-1:~$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /etc\nceph@ceph-1:/etc$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("vim")]),e._v(" hosts\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("127.0")]),e._v(".0.1       localhost\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".90.3   ceph-1\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".90.4   ceph-2\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".70.9    ceph-3\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# The following lines are desirable for IPv6 capable hosts")]),e._v("\n::1     localhost ip6-localhost ip6-loopback\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ceph@ceph-1:/etc$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("ping")]),e._v(" ceph-2\nPING ceph-2 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".90.4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("56")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("84")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" bytes of data.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v(" bytes from ceph-2 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".90.4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(": "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("icmp_seq")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ttl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.597")]),e._v(" ms\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v(" bytes from ceph-2 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".90.4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(": "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("icmp_seq")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ttl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.246")]),e._v(" ms\n^C\n--- ceph-2 "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("ping")]),e._v(" statistics ---\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" packets transmitted, "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" received, "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("% packet loss, "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("time")]),e._v(" 1023ms\nrtt min/avg/max/mdev "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.246")]),e._v("/0.421/0.597/0.176 ms\nceph@ceph-1:/etc$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("ping")]),e._v(" ceph-3\nPING ceph-3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".70.9"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("56")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("84")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" bytes of data.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v(" bytes from ceph-3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".70.9"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(": "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("icmp_seq")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ttl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("63")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.413")]),e._v(" ms\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v(" bytes from ceph-3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".70.9"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(": "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("icmp_seq")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ttl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("63")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.386")]),e._v(" ms\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("64")]),e._v(" bytes from ceph-3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".70.9"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(": "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("icmp_seq")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ttl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("63")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.305")]),e._v(" ms\n^C\n--- ceph-3 "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("ping")]),e._v(" statistics ---\n"),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" packets transmitted, "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" received, "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("% packet loss, "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("time")]),e._v(" 2037ms\nrtt min/avg/max/mdev "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.305")]),e._v("/0.368/0.413/0.045 ms\n")])])]),s("h3",{attrs:{id:"配置sudo免密-可选-方便操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置sudo免密-可选-方便操作"}},[e._v("#")]),e._v(" 配置sudo免密(可选)(方便操作)")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("root@ceph-1:/etc"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# sudo chmod 744 sudoers")]),e._v("\nroot@ceph-1:/etc"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# sudo vim sudoers")]),e._v("\n")])])]),s("p",[e._v("在后面追加一行")]),e._v(" "),s("blockquote",[s("p",[e._v("ceph ALL=(root) NOPASSWD:ALL")])]),e._v(" "),s("p",[e._v("恢复文件权限然后重启")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:/etc$ sudo chmod 0440  sudoers\nceph@ceph-1:/etc$ sudo reboot\n")])])]),s("h2",{attrs:{id:"_2-环境安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-环境安装"}},[e._v("#")]),e._v(" 2.环境安装")]),e._v(" "),s("h3",{attrs:{id:"安装docker环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装docker环境"}},[e._v("#")]),e._v(" 安装docker环境")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" update "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" -y "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    apt-transport-https "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    ca-certificates "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    gnupg-agent "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    software-properties-common\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("curl -fsSL https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -\nOK\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('sudo add-apt-repository "deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu $(lsb_release -cs) stable"\nHit:1 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic InRelease\nHit:2 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-updates InRelease\nHit:3 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-backports InRelease\nHit:4 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-security InRelease\nGet:5 https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu bionic InRelease [64.4 kB]\nGet:6 https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu bionic/stable amd64 Packages [12.5 kB]\nFetched 76.9 kB in 1s (99.0 kB/s)\n')])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" update "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y docker-ce docker-ce-cli containerd.io\n")])])]),s("h3",{attrs:{id:"安装ceph"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装ceph"}},[e._v("#")]),e._v(" 安装ceph")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ curl --silent --remote-name --location https://github.com/ceph/ceph/raw/octopus/src/cephadm/cephadm\nceph@ceph-1:~$ chmod +x cephadm\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo ./cephadm add-repo --release octopus\nINFO:root:Installing repo GPG key from https://download.ceph.com/keys/release.as                                             c...\nINFO:root:Installing repo file at /etc/apt/sources.list.d/ceph.list...\nceph@ceph-1:~$ sudo apt update\nHit:1 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic InRelease\nHit:2 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-updates InRelease\nHit:3 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-backports InRelease\nHit:4 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-security InRelease\nHit:5 https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu bionic InRelea                                             se\nGet:6 https://download.ceph.com/debian-octopus bionic InRelease [8563 B]\nErr:6 https://download.ceph.com/debian-octopus bionic InRelease\n  The following signatures couldn't be verified because the public key is not av                                             ailable: NO_PUBKEY E84AC2C0460F3994\nReading package lists... Done\nW: https://mirrors.tuna.tsinghua.edu.cn/ubuntu/dists/bionic/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.\nW: https://mirrors.tuna.tsinghua.edu.cn/ubuntu/dists/bionic-updates/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.\nW: https://mirrors.tuna.tsinghua.edu.cn/ubuntu/dists/bionic-backports/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.\nW: https://mirrors.tuna.tsinghua.edu.cn/ubuntu/dists/bionic-security/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.\nW: https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu/dists/bionic/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.\nW: https://download.ceph.com/debian-octopus/dists/bionic/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.\nW: GPG error: https://download.ceph.com/debian-octopus bionic InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY E84AC2C0460F3994\nE: The repository 'https://download.ceph.com/debian-octopus bionic InRelease' is not signed.\nN: Updating from such a repository can't be done securely, and is therefore disabled by default.\nN: See apt-secure(8) manpage for repository creation and user configuration details.\n")])])]),s("p",[e._v("可以看到，apt update 出错了，这里有一个坑，官方的apt key是旧版本的，而cephadm安装key的方法是直接拷贝到apt里面，导致出错，错误详细见"),s("a",{attrs:{href:"https://tracker.ceph.com/issues/45009",target:"_blank",rel:"noopener noreferrer"}},[e._v("链接"),s("OutboundLink")],1),e._v(" "),s("img",{attrs:{src:a(498),alt:""}})]),e._v(" "),s("h3",{attrs:{id:"解决方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[e._v("#")]),e._v(" 解决方法:")]),e._v(" "),s("p",[e._v("先删除cephadm拷贝的key")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:/etc$ cd apt\nceph@ceph-1:/etc/apt$ ls\napt.conf    auth.conf.d    sources.list    sources.list.save  trusted.gpg\napt.conf.d  preferences.d  sources.list.d  sources.list~      trusted.gpg.d\nceph@ceph-1:/etc/apt$ cd trusted.gpg.d/\nceph@ceph-1:/etc/apt/trusted.gpg.d$ ls\nceph.release.gpg  ubuntu-keyring-2012-archive.gpg  ubuntu-keyring-2012-cdimage.gpg  ubuntu-keyring-2018-archive.gpg\nceph@ceph-1:/etc/apt/trusted.gpg.d$ sudo rm -rf ceph.release.gpg\n")])])]),s("p",[e._v("再手动下载添加("),s("a",{attrs:{href:"https://download.ceph.com/keys/release.as",target:"_blank",rel:"noopener noreferrer"}},[e._v("下载地址"),s("OutboundLink")],1),e._v(")")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo apt-key add release.asc\nOK\n")])])]),s("p",[e._v("再更新一下")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo apt update\nHit:1 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic InRelease\nHit:2 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-updates InRelease\nHit:3 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-backports InRelease\nHit:4 https://mirrors.tuna.tsinghua.edu.cn/ubuntu bionic-security InRelease\nHit:5 https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu bionic InRelease\nGet:6 https://download.ceph.com/debian-octopus bionic InRelease [8563 B]\nGet:7 https://download.ceph.com/debian-octopus bionic/main amd64 Packages [15.9 kB]\nGet:8 https://download.ceph.com/debian-octopus bionic/main i386 Packages [3266 B]\nFetched 19.2 kB in 2s (9537 B/s)\nReading package lists... Done\nBuilding dependency tree\nReading state information... Done\nAll packages are up to date.\n")])])]),s("h3",{attrs:{id:"顺便换个源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#顺便换个源"}},[e._v("#")]),e._v(" 顺便换个源")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:/etc/apt/sources.list.d$ cat ceph.list\ndeb https://download.ceph.com/debian-octopus bionic main\n")])])]),s("p",[e._v("可以看到cephadm添加了这一行，把地址改为国内源即可")]),e._v(" "),s("blockquote",[s("p",[e._v("deb https://mirrors.tuna.tsinghua.edu.cn/ceph/debian-octopus/ bionic main")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:/etc/apt/sources.list.d$ sudo apt update\n")])])]),s("p",[e._v("然后通过cephadm安装软件包")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo ./cephadm install\nINFO:root:Installing packages ['cephadm']...\nceph@ceph-1:~$ which cephadm\n/usr/sbin/cephadm\n")])])]),s("p",[e._v("其实实际上就是三步，添加apt key，根据版本导入ceph源，然后apt install cephadm，如果通过脚本或ansible可以直接手动就好了")]),e._v(" "),s("h3",{attrs:{id:"导入镜像-如果当前环境网络没有问题可以跳过"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入镜像-如果当前环境网络没有问题可以跳过"}},[e._v("#")]),e._v(" 导入镜像(如果当前环境网络没有问题可以跳过)")]),e._v(" "),s("p",[e._v("打开cephadm的内部可以看出，需要5个镜像\n"),s("img",{attrs:{src:a(499),alt:""}})]),e._v(" "),s("p",[s("img",{attrs:{src:a(500),alt:""}})]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker.io/ceph/ceph:v15\nprom/prometheus:latest\nprom/node-exporter:latest\nceph/ceph-grafana:latest\nprom/alertmanager:latest\n")])])]),s("p",[e._v("根据后面搭建完成的情况看，第一个是必须，后四个最好有")]),e._v(" "),s("p",[e._v("从其他有网络的机docker pull后 docker save 导出，导入到环境机内")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo docker load -i ceph.tar\neb29745b8228: Loading layer  222.6MB/222.6MB\n64ba9041a276: Loading layer  782.9MB/782.9MB\nLoaded image: ceph/ceph:v15\nceph@ceph-3:~$ sudo docker load -i promethus.tar\n1da8e4c8d307: Loading layer [==================================================>]  1.437MB/1.437MB\n7a151fe67625: Loading layer [==================================================>]  2.595MB/2.595MB\nb260acf93b38: Loading layer [==================================================>]  87.18MB/87.18MB\n2aca26a0561a: Loading layer [==================================================>]  49.98MB/49.98MB\n78b7236da63d: Loading layer [==================================================>]  3.584kB/3.584kB\n598b46af43c3: Loading layer [==================================================>]  13.31kB/13.31kB\nc416dca9c497: Loading layer [==================================================>]  28.16kB/28.16kB\nc41930d39a5d: Loading layer [==================================================>]  13.31kB/13.31kB\n883efb2f2811: Loading layer [==================================================>]   5.12kB/5.12kB\na9374a821205: Loading layer [==================================================>]  113.2kB/113.2kB\nc87cd4adecc5: Loading layer [==================================================>]  3.072kB/3.072kB\n724129e57a6e: Loading layer [==================================================>]   5.12kB/5.12kB\nLoaded image: prom/prometheus:v2.18.1\nceph@ceph-3:~$ sudo docker load -i alertmanager.tar\nfef01fa2517b: Loading layer [==================================================>]  23.99MB/23.99MB\n3a76306b204d: Loading layer [==================================================>]  28.87MB/28.87MB\nb5411b0aebd2: Loading layer [==================================================>]  3.072kB/3.072kB\n50bc703e0953: Loading layer [==================================================>]  3.584kB/3.584kB\nLoaded image: prom/alertmanager:latest\nceph@ceph-3:~$ sudo docker load -i ceph-grafana.tar\n5ded7fadc840: Loading layer [==================================================>]  519.2MB/519.2MB\nLoaded image: ceph/ceph-grafana:latest\nceph@ceph-3:~$ sudo docker load -i node-exporter.tar\nbef00f7ac5a9: Loading layer [==================================================>]  5.424MB/5.424MB\nbb208cc3e926: Loading layer [==================================================>]  2.743MB/2.743MB\n53fe7fa9c07c: Loading layer [==================================================>]  19.66MB/19.66MB\nLoaded image: prom/node-exporter:latest\n")])])]),s("h3",{attrs:{id:"启用root"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启用root"}},[e._v("#")]),e._v(" 启用root")]),e._v(" "),s("p",[e._v("其实，在Debian/Ubunut系中，root是不建议开启的，但尽管ceph在文档中说支持非root用户，\n"),s("img",{attrs:{src:a(501),alt:""}}),e._v(" "),s("img",{attrs:{src:a(502),alt:""}}),e._v("\n但实际参数没有")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo ceph cephadm set-user ceph\nno valid command found; 10 closest matches:\ncephadm set-ssh-config\ncephadm clear-ssh-config\ncephadm get-ssh-config\ncephadm generate-key\ncephadm set-priv-key\ncephadm set-pub-key\ncephadm clear-key\ncephadm get-pub-key\ncephadm get-user\ncephadm check-host <host> [<addr>]\nError EINVAL: invalid command\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:/etc/ceph$ sudo cephadm bootstrap --mon-ip 172.16.90.3 --skip-pull --allow-overwrite -ssh-user ceph\nusage: cephadm [-h] [--image IMAGE] [--docker] [--data-dir DATA_DIR]\n               [--log-dir LOG_DIR] [--logrotate-dir LOGROTATE_DIR]\n               [--unit-dir UNIT_DIR] [--verbose] [--timeout TIMEOUT]\n               [--retry RETRY] [--env ENV]\n               {version,pull,inspect-image,ls,list-networks,adopt,rm-daemon,rm-cluster,run,shell,enter,ceph-volume,unit,logs,bootstrap,deploy,check-host,prepare-host,add-repo,rm-repo,install}\n               ...\ncephadm: error: unrecognized arguments: -ssh-user ceph\n")])])]),s("p",[e._v("这些参数在官方文档中均存在，一番折腾后放弃，改为开启root密码和root的ssh登陆")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-2:~$ sudo passwd root\nEnter new UNIX password:\nRetype new UNIX password:\npasswd: password updated successfully\n")])])]),s("p",[e._v("在sshd_config的")]),e._v(" "),s("blockquote",[s("p",[e._v("#PermitRootLogin prohibit-password后加上一行")])]),e._v(" "),s("blockquote",[s("p",[e._v("PermitRootLogin yes")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('ceph@ceph-2:~$ sudo vim /etc/ssh/sshd_config\nceph@ceph-2:~$ sudo systemctl restart sshd\nceph@ceph-2:~$ cat /etc/ssh/sshd_config | grep PermitRootLogin\n#PermitRootLogin prohibit-password\nPermitRootLogin yes\n# the setting of "PermitRootLogin without-password".\n')])])]),s("p",[e._v("接着在其他机上重复hosts，docker安装，sudo免密(可选),镜像导入(可选),开启root密码和root的ssh(cephadm只在一台机安装)")]),e._v(" "),s("h2",{attrs:{id:"_3-ceph初始化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ceph初始化"}},[e._v("#")]),e._v(" 3.ceph初始化")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo mkdir -p /etc/ceph\n")])])]),s("p",[e._v("如果你不是非外网环境通过导入镜像，则不用--skip-pull参数")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo cephadm bootstrap --mon-ip 172.16.90.3 --skip-pull\nINFO:cephadm:Verifying podman|docker is present...\nINFO:cephadm:Verifying lvm2 is present...\nINFO:cephadm:Verifying time synchronization is in place...\nINFO:cephadm:Unit systemd-timesyncd.service is enabled and running\nINFO:cephadm:Repeating the final host check...\nINFO:cephadm:podman|docker (/usr/bin/docker) is present\nINFO:cephadm:systemctl is present\nINFO:cephadm:lvcreate is present\nINFO:cephadm:Unit systemd-timesyncd.service is enabled and running\nINFO:cephadm:Host looks OK\nINFO:root:Cluster fsid: d668a1a0-c90f-11ea-b26d-000c29a0fbf7\nINFO:cephadm:Verifying IP 172.16.90.3 port 3300 ...\nINFO:cephadm:Verifying IP 172.16.90.3 port 6789 ...\nINFO:cephadm:Mon IP 172.16.90.3 is in CIDR network 172.16.90.0/24\nINFO:cephadm:Extracting ceph user uid/gid from container image...\nINFO:cephadm:Creating initial keys...\nINFO:cephadm:Creating initial monmap...\nINFO:cephadm:Creating mon...\nINFO:cephadm:Waiting for mon to start...\nINFO:cephadm:Waiting for mon...\nINFO:cephadm:mon is available\nINFO:cephadm:Assimilating anything we can from ceph.conf...\nINFO:cephadm:Generating new minimal ceph.conf...\nINFO:cephadm:Restarting the monitor...\nINFO:cephadm:Setting mon public_network...\nINFO:cephadm:Creating mgr...\nINFO:cephadm:Wrote keyring to /etc/ceph/ceph.client.admin.keyring\nINFO:cephadm:Wrote config to /etc/ceph/ceph.conf\nINFO:cephadm:Waiting for mgr to start...\nINFO:cephadm:Waiting for mgr...\nINFO:cephadm:mgr not available, waiting (1/10)...\nINFO:cephadm:mgr not available, waiting (2/10)...\nINFO:cephadm:mgr not available, waiting (3/10)...\nINFO:cephadm:mgr not available, waiting (4/10)...\nINFO:cephadm:mgr is available\nINFO:cephadm:Enabling cephadm module...\nINFO:cephadm:Waiting for the mgr to restart...\nINFO:cephadm:Waiting for Mgr epoch 5...\nINFO:cephadm:Mgr epoch 5 is available\nINFO:cephadm:Setting orchestrator backend to cephadm...\nINFO:cephadm:Generating ssh key...\nINFO:cephadm:Wrote public SSH key to to /etc/ceph/ceph.pub\nINFO:cephadm:Adding key to root@localhost's authorized_keys...\nINFO:cephadm:Adding host ceph-1...\nINFO:cephadm:Deploying mon service with default placement...\nINFO:cephadm:Deploying mgr service with default placement...\nINFO:cephadm:Deploying crash service with default placement...\nINFO:cephadm:Enabling mgr prometheus module...\nINFO:cephadm:Deploying prometheus service with default placement...\nINFO:cephadm:Deploying grafana service with default placement...\nINFO:cephadm:Deploying node-exporter service with default placement...\nINFO:cephadm:Deploying alertmanager service with default placement...\nINFO:cephadm:Enabling the dashboard module...\nINFO:cephadm:Waiting for the mgr to restart...\nINFO:cephadm:Waiting for Mgr epoch 13...\nINFO:cephadm:Mgr epoch 13 is available\nINFO:cephadm:Generating a dashboard self-signed certificate...\nINFO:cephadm:Creating initial admin user...\nINFO:cephadm:Fetching dashboard port number...\nINFO:cephadm:Ceph Dashboard is now available at:\n\n             URL: https://ceph-1:8443/\n            User: admin\n        Password: np3que7wjc\n\nINFO:cephadm:You can access the Ceph CLI with:\n\n        sudo /usr/sbin/cephadm shell --fsid d668a1a0-c90f-11ea-b26d-000c29a0fbf7 -c /etc/ceph/ceph.conf -k /etc/ceph/ceph.client.admin.keyring\n\nINFO:cephadm:Please consider enabling telemetry to help improve Ceph:\n\n        ceph telemetry on\n\nFor more information see:\n\n        https://docs.ceph.com/docs/master/mgr/telemetry/\n\nINFO:cephadm:Bootstrap complete.\n")])])]),s("p",[e._v("安装ceph操作包")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo apt install ceph-common\n")])])]),s("h2",{attrs:{id:"_4-完善集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-完善集群"}},[e._v("#")]),e._v(" 4.完善集群")]),e._v(" "),s("h3",{attrs:{id:"导入其他服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入其他服务器"}},[e._v("#")]),e._v(" 导入其他服务器")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('ceph@ceph-1:/etc/ceph$ ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph-2\n/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/etc/ceph/ceph.pub"\nroot@ceph-2\'s password:\n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   "ssh \'root@ceph-2\'"\nand check to make sure that only the key(s) you wanted were added.\n\nceph@ceph-1:/etc/ceph$ ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph-3\n/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/etc/ceph/ceph.pub"\nroot@ceph-3\'s password:\n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   "ssh \'root@ceph-3\'"\nand check to make sure that only the key(s) you wanted were added.\n')])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo ceph orch host add ceph-2\nAdded host 'ceph-2'\nceph@ceph-1:~$ sudo ceph orch host add ceph-3\nAdded host 'ceph-3'\nceph@ceph-1:~$ sudo ceph orch host ls\nHOST    ADDR    LABELS  STATUS\nceph-1  ceph-1\nceph-2  ceph-2\nceph-3  ceph-3\n")])])]),s("h3",{attrs:{id:"加入osd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#加入osd"}},[e._v("#")]),e._v(" 加入osd")]),e._v(" "),s("p",[e._v("先看看磁盘")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo fdisk -l\nDisk /dev/sda: 30 GiB, 32212254720 bytes, 62914560 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x3d5859e2\n\nDevice     Boot Start      End  Sectors Size Id Type\n/dev/sda1  *     2048 62912511 62910464  30G 8e Linux LVM\n\n\nDisk /dev/sdb: 300 GiB, 322122547200 bytes, 629145600 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n\n\nDisk /dev/mapper/ceph--1--vg-root: 29 GiB, 31172067328 bytes, 60882944 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n\n\nDisk /dev/mapper/ceph--1--vg-swap_1: 976 MiB, 1023410176 bytes, 1998848 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n")])])]),s("p",[e._v("我们导入sdb硬盘")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo ceph orch daemon add osd ceph-1:/dev/sdb\nCreated osd(s) 0 on host 'ceph-1'\nceph@ceph-1:~$ sudo ceph orch daemon add osd ceph-2:/dev/sdb\nCreated osd(s) 1 on host 'ceph-2'\nceph@ceph-1:~$ sudo ceph orch daemon add osd ceph-3:/dev/sdb\nCreated osd(s) 2 on host 'ceph-3'\n")])])]),s("h2",{attrs:{id:"_5-验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-验证"}},[e._v("#")]),e._v(" 5.验证")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo ceph -s\n  cluster:\n    id:     d668a1a0-c90f-11ea-b26d-000c29a0fbf7\n    health: HEALTH_WARN\n            failed to probe daemons or devices\n            clock skew detected on mon.ceph-2\n\n  services:\n    mon: 2 daemons, quorum ceph-1,ceph-2 (age 112s)\n    mgr: ceph-1.ieitdi(active, since 6m), standbys: ceph-3.nrfhhu\n    osd: 3 osds: 2 up (since 22s), 2 in (since 22s)\n\n  data:\n    pools:   1 pools, 1 pgs\n    objects: 0 objects, 0 B\n    usage:   2.0 GiB used, 598 GiB / 600 GiB avail\n    pgs:     1 active+undersized\n\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ceph@ceph-1:~$ sudo ceph -s\n  cluster:\n    id:     d668a1a0-c90f-11ea-b26d-000c29a0fbf7\n    health: HEALTH_WARN\n            clock skew detected on mon.ceph-2\n\n  services:\n    mon: 2 daemons, quorum ceph-1,ceph-2 (age 2m)\n    mgr: ceph-1.ieitdi(active, since 6m), standbys: ceph-3.nrfhhu\n    osd: 3 osds: 3 up (since 50s), 3 in (since 50s)\n\n  data:\n    pools:   1 pools, 1 pgs\n    objects: 0 objects, 0 B\n    usage:   3.0 GiB used, 897 GiB / 900 GiB avail\n    pgs:     1 active+clean\n")])])]),s("p",[e._v("当看到osd数量为刚才添加的3时，则集群就完成了")]),e._v(" "),s("p",[e._v("再看看dashboard\n"),s("img",{attrs:{src:a(503),alt:""}})]),e._v(" "),s("p",[s("img",{attrs:{src:a(504),alt:""}})]),e._v(" "),s("p",[s("img",{attrs:{src:a(505),alt:""}})]),e._v(" "),s("p",[s("img",{attrs:{src:a(506),alt:""}})]),e._v(" "),s("p",[e._v("至此，ceph集群初始化完毕，再根据需求使用cephfs或rbd")]),e._v(" "),s("p",[e._v("附上cephfs的创建命令")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('sudo ceph orch apply mds cephfs --placement="1 ceph-1"   #1为数量，创建cephfs前要先新建mds\nsudo ceph osd pool create cephfs_data\nsudo ceph osd pool create cephfs_metadata\nsudo ceph fs new cephfs cephfs_metadata cephfs_data\nsudo ceph fs ls\nsudo ceph mds stat\n然后就可以在你的dashboard看到cephfs了\n')])])]),s("p",[e._v("连接cephfs")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo ceph auth get client.admin  #先获取连接密钥\nsudo mount -t ceph 192.168.90.3:6789:/ /mnt/fs -o name=admin,secret=AQCKcf1eLigAGRAAc/0TeHG2zBy+kuqdM8MItw== #然后可以挂载了\n")])])]),s("p",[e._v("测试速度")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("rados bench seconds mode [ -b objsize ] [ -t threads ]\n参数说明：mode 可以是 write、seq 、rand。 seq和rand分别是顺序读、随机读压力测试，默认对象尺寸是4MB，默认模拟线程数为16。加--no-cleanup是为了测试后面的读\nrados bench -p pool名称 30 write -b blocksize --no-cleanup\nrados bench -p scbench 30 seq\nrados bench -p scbench 30 rand\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);